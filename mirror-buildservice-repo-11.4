#!/bin/sh

# Mirrors the home:vjt:ifad builservice repo for OpenSUSE 11.4,
# using ftp5.gwdg.de. Meant to be run daily.
#
#  -- m.barnaba@ifad.org  Fri Sep 27 16:13:19 CEST 2013
#
source $(dirname $(realpath $0))/.config.subr
create_lock

# The FTP host used for legacy distros
#
FTP_HOST=ftp5.gwdg.de

MIRROR_DIR=$MIRROR_DIR/repositories
REPO=$BUILDSERVICE_REPO/openSUSE_11.4/
REPO_DIR=$MIRROR_DIR/$REPO
SOURCE="--cut-dirs 3 ftp://$FTP_HOST/pub/opensuse/repositories/$REPO"

echo
echo "-----------------------------------------------------------------------"
echo "`date` - OpenSuSE buildservice repo for 11.4 mirror started"

cd $MIRROR_DIR

# Fetch only our $REPO
#
$WGET --quiet --no-host-directories --recursive --continue $SOURCE

ret=$?

echo "`date` - OpenSuSE buildservice repo for 11.4 mirror completed with status $ret"
echo "-----------------------------------------------------------------------"
echo

replace_repo_uris
exit $ret
